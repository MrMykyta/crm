/* ChatPage.module.css */
/* ===== ROOT LAYOUT ===== */

.wrap {
  position: relative;
  display: flex;
  height: calc(97vh - var(--topbar-h) - 2 * var(--space-3));
  margin: var(--space-3);
  border-radius: var(--radius-lg);
  background: var(--sidebar-bg);
  backdrop-filter: blur(var(--glass-blur));
  background-blend-mode: normal, screen, screen;
  box-shadow: var(--elev-3);
  border: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  overflow: hidden;
}

/* ===== SIDEBAR ===== */

.sidebar {
  width: 25rem;
  min-width: 16.5rem;
  max-width: 25rem;
  display: flex;
  flex-direction: column;
  background: var(--sidebar-bg);
  border-right: 1px solid var(--sidebar-brd);
  color: var(--sidebar-text);
  backdrop-filter: blur(var(--glass-blur));
}

/* HEADER (Чаты + иконка) */

.sidebarHeader {
  padding: var(--space-4) var(--space-3) var(--space-2);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.sidebarTitle {
  font-size: var(--fs-md);
  font-weight: var(--fw-bold);
}

.sidebarHeaderRight {
  position: relative;
  display: flex;
  align-items: center;
}

/* кнопка "новый чат" */

.newChatBtn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-full);
  background: transparent;
  border: 1px solid color-mix(in srgb, #ffffff 35%, transparent);
  cursor: pointer;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    opacity var(--tr-fast);
  box-shadow: none;
  padding: 0;
}

.newChatBtnIcon {
  color: #fff;
}

.newChatBtn:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 255, 255, 0.4);
}

.newChatBtnActive {
  background: rgba(255, 255, 255, 0.12);
  border-color: rgba(255, 255, 255, 0.55);
}

/* DROPDOWN */

.newChatMenu {
  position: absolute;
  left: 0;
  top: calc(100% + 8px);
  min-width: 230px;
  background: radial-gradient(
    circle at top right,
    rgba(255, 255, 255, 0.08) 0%,
    rgba(15, 17, 25, 0.95) 40%
  );
  backdrop-filter: blur(20px);
  border: 1px solid color-mix(in srgb, var(--card-brd) 90%, transparent);
  border-radius: 14px;
  box-shadow: 0 18px 45px rgba(0, 0, 0, 0.65);
  padding: 6px;
  z-index: 20;
}

.newChatItem {
  width: 100%;
  padding: 10px 14px;
  border: none;
  background: transparent;
  color: var(--text);
  font-size: var(--fs-sm);
  display: flex;
  align-items: center;
  gap: 10px;
  border-radius: 10px;
  cursor: pointer;
  transition: background var(--tr-fast);
}

.newChatItem:first-child {
  margin-bottom: 2px;
}

.newChatItem:last-child {
  margin-top: 2px;
}

.newChatItem:hover {
  background: rgba(255, 255, 255, 0.1);
}

/* ===== SEARCH ===== */

.headerSearchWrap {
  padding: 0 var(--space-3) var(--space-3);
  border-bottom: 1px solid
    color-mix(in srgb, var(--sidebar-brd) 80%, transparent);
}

.searchInputHeader {
  width: 100%;
  padding: var(--space-3) var(--space-3);
  border-radius: var(--radius-xl);
  border: 1px solid color-mix(in srgb, var(--card-brd) 75%, transparent);
  background: rgba(255, 255, 255, 0.03);
  font-size: var(--fs-sm);
  color: var(--text);
  outline: none;
  transition: border-color var(--tr-fast), background var(--tr-fast),
    box-shadow var(--tr-fast);
}

.searchInputHeader::placeholder {
  color: var(--muted);
}

.searchInputHeader:focus {
  background: rgba(255, 255, 255, 0.06);
  border-color: var(--primary-start);
  box-shadow: var(--elev-1);
}

/* ===== ROOMS LIST ===== */

.roomsList {
  flex: 1;
  overflow-y: auto;
  padding: 0 var(--space-2) var(--space-2);
}

.roomsEmpty {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-3);
  font-size: var(--fs-xs);
  color: var(--muted);
}

.room,
.roomActive {
  position: relative;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  cursor: pointer;
  margin-bottom: var(--space-2);
  background: transparent;
  border: 1px solid transparent;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    transform var(--tr-fast), box-shadow var(--tr-fast);

  display: flex;
  align-items: center;
  gap: 10px;
}

.roomAvatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: linear-gradient(135deg, #7d5fff, #4a33d4);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  color: #ffffff;
  flex-shrink: 0;
}

.roomText {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
}

.room:hover {
  background: var(--sidebar-hover);
  border-color: color-mix(in srgb, var(--primary-start) 35%, transparent);
  transform: translateY(-1px);
  box-shadow: var(--elev-1);
}

.roomActive {
  background: var(--sidebar-active);
  border-color: color-mix(in srgb, var(--primary-start) 60%, transparent);
  box-shadow: var(--elev-1);
}

.roomTitle {
  font-size: var(--fs-sm);
  font-weight: var(--fw-medium);
  margin-bottom: 2px;
}

.roomPreview {
  font-size: var(--fs-2xs);
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ===== MAIN CHAT WINDOW ===== */

.window {
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
  background: radial-gradient(
      1000px 700px at 110% 110%,
      color-mix(in srgb, var(--primary-end) 26%, transparent) 0%,
      transparent 60%
    ),
    transparent;
  color: var(--text);
  min-width: 0;
}

.empty {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--fs-md);
  color: var(--muted);
}

/* ===== CHAT HEADER ===== */

.chatHeader {
  height: 64px;
  padding: 0 var(--space-4);
  border-bottom: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: color-mix(in srgb, var(--card-bg) 92%, transparent);
  backdrop-filter: blur(var(--glass-blur));
}

.chatHeaderMain {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.chatAvatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary-start), var(--primary-end));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--fs-sm);
  font-weight: var(--fw-bold);
  color: #fff;
}

.chatHeaderTexts {
  display: flex;
  flex-direction: column;
}

.chatTitle {
  font-size: var(--fs-md);
  font-weight: var(--fw-medium);
}

.chatSubtitle {
  font-size: var(--fs-xs);
  color: var(--muted);
}

.chatHeaderActions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.chatHeaderBtn {
  width: 32px;
  height: 32px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 70%, transparent);
  background: transparent;
  color: var(--text);
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    transform var(--tr-fast);
}

.chatHeaderBtn:hover {
  background: var(--sidebar-hover);
  border-color: var(--primary-start);
  transform: translateY(-1px);
}

/* ===== FLOATING DAY LABEL ===== */

.floatingDayLabel {
  position: absolute;
  top: 64px;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  pointer-events: none;
  z-index: 15;
}

.floatingDayLabelInner {
  padding: 4px 14px;
  border-radius: 999px;
  font-size: 12px;
  letter-spacing: 0.02em;
  background: color-mix(in srgb, var(--card-bg) 88%, transparent);
  border: 1px solid color-mix(in srgb, var(--card-brd) 90%, transparent);
  color: color-mix(in srgb, var(--muted) 96%, transparent);
  backdrop-filter: blur(var(--glass-blur));
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.28);
}

/* ===== MESSAGES ===== */

.messages {
  flex: 1;
  padding: var(--space-4);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.messagesScrollable {
}

.messagesScrolled {
}

/* статичный разделитель даты в ленте */
.dayDivider {
  display: flex;
  justify-content: center;
  margin: 16px 0 12px;
}

.dayDivider > span {
  padding: 4px 14px;
  border-radius: 999px;
  font-size: 12px;
  letter-spacing: 0.02em;
  background: color-mix(in srgb, var(--card-bg) 88%, transparent);
  border: 1px solid color-mix(in srgb, var(--card-brd) 90%, transparent);
  color: color-mix(in srgb, var(--muted) 96%, transparent);
  backdrop-filter: blur(var(--glass-blur));
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.18);
}

/* общий пузырь (legacy, почти не используется напрямую) */
.message {
  max-width: 70%;
  background: color-mix(in srgb, var(--card-bg) 90%, transparent);
  border-radius: var(--radius-lg);
  border: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  box-shadow: var(--elev-1);
  font-size: var(--fs-sm);
  line-height: var(--lh-normal);
  display: flex;
  flex-direction: column;
  padding: var(--space-2) var(--space-3);
}

/* === TELEGRAM-LIKE MESSAGE ROWS === */

.messageWrap {
  display: flex;
  align-items: flex-end;
  margin-bottom: 8px;
  max-width: 80%;
  gap: 8px;
}

/* подсветка выбранных сообщений */
.messageWrapSelected .msgBubble {
  box-shadow: 0 0 0 2px rgba(80, 140, 255, 0.9);
}

.messageWrapSelected.meWrap .msgBubble {
  box-shadow: 0 0 0 2px rgba(80, 190, 255, 0.9);
}

.msgBubbleHighlight {
  animation: msgJumpFlash 0.9s ease-out;
}

@keyframes msgJumpFlash {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 214, 102, 0.75);
    background-color: rgba(255, 248, 204, 0.95);
  }
  40% {
    box-shadow: 0 0 0 6px rgba(255, 214, 102, 0.0);
    background-color: rgba(255, 248, 204, 0.6);
  }
  100% {
    box-shadow: none;
    background-color: inherit;
  }
}

/* мои сообщения — справа */
.meWrap {
  margin-left: auto;
  justify-content: flex-end;
}

/* чужие — слева */
.otherWrap {
  margin-right: auto;
  justify-content: flex-start;
}

/* аватар слева от пузыря */
.msgAvatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: linear-gradient(135deg, #7d5fff, #4a33d4);
  color: #fff;
  font-weight: 600;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.avatarImg {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: cover;
  object-position: center;
  border-radius: 50%;
}

/* у моих сообщений аватар не нужен */
.meWrap .msgAvatar {
  display: none;
}

/* сам пузырь */
.msgBubble {
  position: relative;
  background: var(--card-bg);
  padding: 8px 10px 6px 10px;
  border-radius: 16px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 70%, transparent);
  box-shadow: var(--elev-1);
  max-width: 420px;
  word-break: break-word;
}

/* мои пузыри — градиент */
.meWrap .msgBubble {
  background: linear-gradient(
    135deg,
    color-mix(in srgb, var(--primary-start) 85%, transparent),
    color-mix(in srgb, var(--primary-end) 85%, transparent)
  );
  border-color: transparent;
  color: #fff;
}

/* текст */
.msgText {
  white-space: pre-wrap;
  word-break: break-word;
  font-size: var(--fs-sm);
}

/* время справа внизу */
.msgTime {
  font-size: var(--fs-3xs, 10px);
  opacity: 0.75;
  text-align: right;
  margin-top: 4px;
}

/* имя автора в группе */
.messageAuthorRow {
  margin-bottom: 2px;
}

.messageAuthorName {
  font-size: var(--fs-xs);
  font-weight: var(--fw-medium);
  opacity: 0.9;
}

/* ===== ХВОСТИКИ ===== */

.otherWrap .msgBubble {
  border-radius: 16px 16px 16px 2px;
}

.meWrap .msgBubble {
  border-radius: 16px 16px 2px 16px;
}

/* ===== МЕТА-СТРОКА: ВРЕМЯ + ГАЛОЧКИ ===== */

.msgMetaRow {
  margin-top: 4px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 4px;
}

/* внутри общей мета-строки время без extra-отступа */
.msgMetaRow .msgTime {
  margin-top: 0;
}

/* контейнер под статус */
.msgStatus {
  display: flex;
  align-items: center;
  font-size: 0;
}

.msgCheckIcon {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.msgCheckLayer {
  position: relative;
  display: inline-block;
  font-size: 11px;
}

.msgCheckLayer + .msgCheckLayer {
  margin-left: -3px;
}

.msgCheckSent {
  color: rgba(255, 255, 255, 0.7);
  opacity: 0.7;
}

.msgCheckPartial {
  color: rgba(255, 255, 255, 0.9);
  opacity: 0.9;
}

.msgCheckRead {
  color: #4fc3ff;
  opacity: 1;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.35);
}

.meWrap .msgMetaRow {
  justify-content: flex-end;
}

/* ===== ПОДПИСИ REPLY / FORWARD ===== */

/* "Переслано от ..." над текстом */
.msgForwardLabel {
  font-size: var(--fs-xs);
  color: var(--muted);
  margin-bottom: 4px;
}

/* контейнер прелюда ответа */
.msgReplyPreview {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  padding: 4px 6px;
  margin: -2px -4px 4px -4px;
  border-radius: 10px;
  background: color-mix(in srgb, var(--muted) 20%, transparent);
}

.msgReplyPreviewBar {
  width: 3px;
  border-radius: 999px;
  background: #508cff;
  flex-shrink: 0;
  margin-top: 1px;
}

.msgReplyPreviewContent {
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.msgReplyPreviewTitle {
  font-size: var(--fs-xs);
  font-weight: var(--fw-medium);
  color: #508cff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.msgReplyPreviewText {
  font-size: var(--fs-2xs);
  color: var(--muted);
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.meWrap .msgReplyPreview {
  background: rgba(0, 0, 0, 0.18);
}

.meWrap .msgReplyPreviewBar {
  background: rgba(255, 255, 255, 0.9);
}

.meWrap .msgReplyPreviewTitle {
  color: #ffffff;
}

/* ===== КНОПКА ⋯ (сейчас не используется, но пусть будет) ===== */

.msgActionsBtn {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 75%, transparent);
  background: rgba(10, 12, 22, 0.35);
  color: var(--muted);
  font-size: 0;
  line-height: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.35);
  transition: opacity 0.12s ease, background 0.12s ease, transform 0.12s ease,
    border-color 0.12s ease, color 0.12s ease, box-shadow 0.12s ease;
}

.msgActionsBtn::before {
  content: "⋮";
  font-size: 16px;
  line-height: 1;
  color: inherit;
}

.messageWrap:hover .msgActionsBtn {
  opacity: 1;
}

.msgActionsBtn:hover {
  background: color-mix(in srgb, var(--sidebar-hover) 90%, transparent);
  border-color: var(--primary-start);
  color: #ffffff;
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(0, 0, 0, 0.45);
}

.meWrap .msgActionsBtn {
  margin-right: 4px;
}

.otherWrap .msgActionsBtn {
  margin-left: 4px;
}

/* ===== INPUT AREA ===== */

.input {
  display: flex;
  align-items: flex-end;
  gap: 8px;
  padding: 10px 12px;
  border-top: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  background: color-mix(in srgb, var(--card-bg) 95%, transparent);
  backdrop-filter: blur(var(--glass-blur));
}

.inputRow {
  display: flex;
  align-items: flex-end;
  gap: 8px;
}

.inputMain {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
  min-width: 0;
}

.inputTextWrap {
  flex: 1;
  display: flex;
  min-width: 0;
}

/* textarea */
.textbox {
  width: 100%;
  min-height: 38px;
  max-height: 35vh;
  padding: 8px 12px;
  border-radius: 16px;
  border: 1px solid var(--card-brd);
  background: var(--input-bg);
  color: var(--text);
  font-size: var(--fs-sm);
  line-height: var(--lh-normal);
  outline: none;
  resize: none;
  overflow-y: hidden;
  transition: border-color var(--tr-fast), box-shadow var(--tr-fast),
    background var(--tr-fast);
}

.textbox:focus {
  border-color: var(--focus);
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--focus) 80%, transparent);
  background: color-mix(in srgb, var(--input-bg) 90%, transparent);
}

/* маленькие круглые иконки */
.inputIconBtn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 1px solid color-mix(in srgb, var(--card-brd) 70%, transparent);
  background: transparent;
  color: var(--muted);
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    transform var(--tr-fast), color var(--tr-fast), opacity var(--tr-fast);
}

.inputIconBtn:hover {
  background: color-mix(in srgb, var(--sidebar-hover) 80%, transparent);
  border-color: var(--primary-start);
  color: var(--text);
  transform: translateY(-1px);
}

/* кнопка отправки */
.sendIconBtn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  background: linear-gradient(135deg, var(--primary-start), var(--primary-end));
  color: #fff;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  box-shadow: var(--elev-2);
  transition: transform var(--tr-fast), box-shadow var(--tr-fast),
    opacity var(--tr-fast), filter var(--tr-fast);
}

.sendIconBtn:disabled {
  opacity: 0.45;
  box-shadow: none;
  cursor: default;
}

.sendIconBtn:not(:disabled):hover {
  transform: translateY(-1px);
  filter: brightness(1.05);
}

.sendIconBtn:not(:disabled):active {
  transform: translateY(0);
  box-shadow: var(--elev-1);
}

/* ------------------------------- */
/*      CREATE DIRECT / GROUP      */
/* ------------------------------- */

.createWrap {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 24px;
  background: rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(8px);
  overflow: hidden;
}

.createHeader {
  margin-bottom: 20px;
}

.createTitle {
  font-size: 22px;
  font-weight: 600;
  color: #fff;
  margin-bottom: 4px;
}

.createSubtitle {
  font-size: 14px;
  color: #b2b4bd;
}

/* SEARCH INPUT */
.createSearch {
  margin-bottom: 16px;
}

.createSearchInput {
  width: 100%;
  padding: 16px 20px;
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 14px;
  outline: none;
  color: #fff;
  font-size: 15px;
  transition: 0.2s;
}

.createSearchInput::placeholder {
  color: #6e7080;
}

.createSearchInput:focus {
  border-color: rgba(113, 108, 247, 0.7);
  background: rgba(255, 255, 255, 0.08);
}

/* ERROR */
.createError {
  padding: 12px;
  background: rgba(255, 70, 70, 0.15);
  border: 1px solid rgba(255, 70, 70, 0.25);
  border-radius: 10px;
  color: #ff6b6b;
  font-size: 14px;
  margin-bottom: 16px;
}

/* USER LIST */
.userList {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0;
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.userList::-webkit-scrollbar {
  width: 6px;
}

.userList::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 8px;
}

/* ОДНА СТРОКА ПОЛЬЗОВАТЕЛЯ */
.userRow {
  width: calc(100% - 24px);
  margin: 0 auto;
  display: flex;
  align-items: center;
  padding: 20px 22px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.08);
  cursor: pointer;
  transition: 0.18s ease;
}

.userRow:hover {
  background: rgba(255, 255, 255, 0.1);
}

/* выбрана (для группы) */
.userRowSelected {
  background: rgba(123, 97, 255, 0.35);
  border-color: rgba(147, 124, 255, 0.9);
}

/* AVATAR */
.userAvatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  flex-shrink: 0;
  margin-right: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #7d5fff, #4a33d4);
  font-size: 17px;
}

.userInitials {
  pointer-events: none;
}

/* Имя + email */
.userMain {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.userName {
  font-size: 16px;
  font-weight: 600;
}

.userEmail {
  font-size: 14px;
  opacity: 0.7;
}

/* Кружок выбора справа */
.userCheckWrap {
  margin-left: 18px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.userCheckCircle {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.2);
  opacity: 0.8;
  display: flex;
  align-items: center;
  justify-content: center;
}

.userBusyDot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #6b5cff;
}

/* FOOTER ДЛЯ ГРУППЫ */
.createFooter {
  padding-top: 16px;
  margin-top: 4px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  display: flex;
  gap: 12px;
}

.groupTitleInput {
  flex: 1;
  padding: 12px 16px;
  border-radius: 14px;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: rgba(0, 0, 0, 0.35);
  color: #fff;
  font-size: 14px;
  outline: none;
}

.groupTitleInput::placeholder {
  color: #7b7d8a;
}

.groupTitleInput:focus {
  border-color: rgba(123, 97, 255, 0.9);
}

.groupCreateBtn {
  padding: 0 20px;
  border-radius: 999px;
  border: none;
  background: linear-gradient(135deg, #7c5cff, #4a32d4);
  color: #fff;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  white-space: nowrap;
  transition: 0.18s ease;
}

.groupCreateBtn:disabled {
  opacity: 0.4;
  cursor: default;
}

.groupCreateBtn:not(:disabled):hover {
  transform: translateY(-1px);
}

/* BACK BUTTON */

.backBtn {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: color-mix(in srgb, var(--bg) 80%, transparent);
  color: var(--muted);
  border: 1px solid var(--glass-brd);
  cursor: pointer;
  transition: 0.15s ease;
}

.backBtn:hover {
  background: color-mix(in srgb, var(--bg) 40%, transparent);
  color: var(--text);
}

/* ===== SEARCH BAR IN CHAT HEADER ===== */

.chatSearchBar {
  padding: 4px var(--space-4) 6px;
  border-bottom: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  display: flex;
  align-items: center;
  gap: 8px;
  background: color-mix(in srgb, var(--card-bg) 96%, transparent);
  backdrop-filter: blur(var(--glass-blur));
}

.chatSearchInput {
  flex: 1;
  padding: 6px 10px;
  border-radius: var(--radius-md);
  border: 1px solid color-mix(in srgb, var(--card-brd) 75%, transparent);
  background: rgba(255, 255, 255, 0.02);
  font-size: var(--fs-xs);
  color: var(--text);
  outline: none;
  transition: border-color var(--tr-fast), background var(--tr-fast),
    box-shadow var(--tr-fast);
}

.chatSearchInput::placeholder {
  color: var(--muted);
}

.chatSearchInput:focus {
  background: rgba(255, 255, 255, 0.06);
  border-color: var(--primary-start);
  box-shadow: var(--elev-1);
}

.chatSearchCounter {
  min-width: 52px;
  text-align: center;
  font-size: var(--fs-2xs);
  color: var(--muted);
}

.chatSearchNavBtn {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 75%, transparent);
  background: transparent;
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    transform var(--tr-fast), opacity var(--tr-fast);
}

.chatSearchNavBtn:disabled {
  opacity: 0.4;
  cursor: default;
}

.chatSearchNavBtn:not(:disabled):hover {
  background: var(--sidebar-hover);
  border-color: var(--primary-start);
  transform: translateY(-1px);
}

/* подсветка совпадений */
.msgHighlight {
  background: color-mix(in srgb, var(--danger) 80%, transparent);
  border-radius: 4px;
  padding: 0 1px;
}

.chatSearchCloseBtn {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 75%, transparent);
  background: transparent;
  color: var(--muted);
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    transform var(--tr-fast), opacity var(--tr-fast);
}

.chatSearchCloseBtn:hover {
  background: var(--sidebar-hover);
  color: var(--text);
  border-color: var(--primary-start);
  transform: translateY(-1px);
}

/* ===== CONTEXT MENU ===== */

.ctxOverlay {
  position: fixed;
  inset: 0;
  z-index: 2000;
  pointer-events: auto;
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
}

.ctxMenu {
  position: fixed;
  min-width: 170px;
  max-width: 220px;
  background: linear-gradient(
    135deg,
    rgba(16, 20, 35, 0.98),
    rgba(22, 30, 52, 0.98)
  );
  color: #fff;
  border-radius: 14px;

  box-shadow: 0 18px 45px rgba(0, 0, 0, 0.45);
  backdrop-filter: blur(18px);
  border: 1px solid rgba(255, 255, 255, 0.06);
  overflow: hidden;
  font-size: 14px;
  animation: ctxMenuFadeIn 0.14s ease-out;
  transform-origin: 50% 50%;
}

.ctxMenu[data-side="me"] {
  transform-origin: 100% 50%;
}

.ctxMenu[data-side="other"] {
  transform-origin: 0% 50%;
}

.ctxMenuItem {
  width: 100%;
  padding: 7px 14px;
  background: none;
  border: none;
  border-radius: none;
  outline: none;
  color: inherit;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  text-align: left;
  white-space: nowrap;
}

.ctxMenuItem:hover {
  background: rgba(255, 255, 255, 0.06);
}

.ctxMenuItemDanger {
  color: #ff6b6b;
}

.ctxMenuItemDanger:hover {
  background: rgba(255, 107, 107, 0.12);
}

.ctxMenuSeparator {
  margin: 4px 0;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
}

.ctxMenuIcon {
  width: 18px;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  opacity: 0.9;
  font-size: 14px;
}

@keyframes ctxMenuFadeIn {
  from {
    opacity: 0;
    transform: scale(0.96) translateY(4px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* ===== REPLY / FORWARD BANNER над инпутом ===== */

.replyWrap {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 12px;
  background: color-mix(in srgb, var(--card-bg) 96%, transparent);
  border: 1px solid color-mix(in srgb, var(--card-brd) 85%, transparent);
  max-width: 100%;
  overflow: hidden;
}

.replyLeft {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.replyIcon {
  width: 22px;
  height: 22px;
  border-radius: 999px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  background: rgba(80, 140, 255, 0.12);
  color: #508cff;
  flex-shrink: 0;
}

.replyTexts {
  display: flex;
  flex-direction: column;
  min-width: 0;
  max-width: 100%;
}

.replyTitle {
  font-size: var(--fs-xs);
  font-weight: var(--fw-medium);
  color: #508cff;
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.replyText {
  font-size: var(--fs-2xs);
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.replyCloseBtn {
  width: 22px;
  height: 22px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--card-brd) 80%, transparent);
  background: transparent;
  color: var(--muted);
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: background var(--tr-fast), border-color var(--tr-fast),
    color var(--tr-fast), transform var(--tr-fast), opacity var(--tr-fast);
}

.replyCloseBtn:hover {
  background: color-mix(in srgb, var(--sidebar-hover) 80%, transparent);
  border-color: var(--primary-start);
  color: var(--text);
  transform: translateY(-1px);
}

/* ===== MODAL: ПЕРЕСЛАТЬ СООБЩЕНИЕ ===== */

.forwardModal {
  position: relative;
  width: 420px;
  max-width: 90vw;
  max-height: 520px;
  display: flex;
  flex-direction: column;
  padding: 12px 14px 14px;
  border-radius: 18px;
  background: linear-gradient(
    135deg,
    rgba(16, 20, 35, 0.98),
    rgba(27, 34, 63, 0.98)
  );
  box-shadow: 0 22px 55px rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(22px);
  border: 1px solid rgba(255, 255, 255, 0.06);
  color: #f5f6ff;
  font-size: 14px;
  animation: forwardModalFadeIn 0.18s ease-out;
}

@keyframes forwardModalFadeIn {
  from {
    opacity: 0;
    transform: scale(0.96) translateY(6px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.forwardHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 2px 2px 8px;
  margin-bottom: 4px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.forwardTitle {
  font-size: 14px;
  font-weight: 500;
  color: #ffffff;
}

.forwardCloseBtn {
  width: 24px;
  height: 24px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.18);
  background: transparent;
  color: #b0b4c8;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: 0.15s ease;
}

.forwardCloseBtn:hover {
  background: rgba(255, 255, 255, 0.09);
  color: #ffffff;
}

/* список чатов */

.forwardList {
  margin-top: 4px;
  padding: 2px;
  flex: 1;
  overflow-y: auto;
}

.forwardList::-webkit-scrollbar {
  width: 6px;
}

.forwardList::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.18);
  border-radius: 999px;
}

/* строка чата */

.forwardItem {
  width: 100%;
  padding: 8px 10px;
  border-radius: 12px;
  border: none;
  background: transparent;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  color: inherit;
  text-align: left;
  transition: background 0.15s ease, transform 0.12s ease,
    box-shadow 0.12s ease;
}

.forwardItem:hover {
  background: rgba(255, 255, 255, 0.07);
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(0, 0, 0, 0.45);
}

.forwardItemCurrent {
  background: linear-gradient(
    135deg,
    rgba(124, 92, 255, 0.35),
    rgba(102, 76, 235, 0.16)
  );
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
}

/* аватарка комнаты */

.forwardItemAvatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #7d5fff, #4a33d4);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
  color: #ffffff;
  flex-shrink: 0;
}

/* текст справа от аватарки */

.forwardItemTexts {
  display: flex;
  flex-direction: column;
  min-width: 0;
}

.forwardItemTitle {
  font-size: 13px;
  font-weight: 500;
  color: #f5f6ff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.forwardItemSub {
  font-size: 11px;
  color: #a5a8c4;
  margin-top: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ===== НИЖНЯЯ ПАНЕЛЬ ВЫБОРА СООБЩЕНИЙ ===== */

.selectBar {
  position: relative;
  z-index: 5;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 16px 11px;
  border-top: 1px solid rgba(255, 255, 255, 0.06);
  background: linear-gradient(
    180deg,
    rgba(8, 10, 18, 0.98),
    rgba(10, 12, 22, 0.98)
  );
  color: #f5f6ff;
  font-size: 14px;
}

.selectBarLabel {
  flex: 1;
  text-align: center;
  font-size: 14px;
  font-weight: 500;
}

.selectBarBtnDanger,
.selectBarBtnPrimary {
  border-radius: 999px;
  border: none;
  padding: 6px 14px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  white-space: nowrap;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: 0.14s ease;
}

.selectBarBtnDanger {
  background: transparent;
  color: #ff6b6b;
}

.selectBarBtnDanger:hover {
  background: rgba(255, 107, 107, 0.15);
}

.selectBarBtnPrimary {
  background: linear-gradient(135deg, #7c5cff, #4a32d4);
  color: #ffffff;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.55);
}

.selectBarBtnPrimary:disabled {
  opacity: 0.4;
  cursor: default;
  box-shadow: none;
}

.selectBarBtnPrimary:not(:disabled):hover {
  transform: translateY(-1px);
}