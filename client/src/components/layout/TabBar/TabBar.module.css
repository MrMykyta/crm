
.wrap {
  --collapsed-h: 40px;
  --reserve-w: 44px;
  --anim-ms: 260ms;
  position: relative;
  border: 1px solid var(--card-brd);
  background: color-mix(in srgb, var(--card-bg) 96%, transparent);
  border-radius: 12px;
  padding: 8px;
  color: var(--text);
  overflow: visible;
}

.frame {
  height: var(--collapsed-h);
  overflow: visible;
  transition: height var(--anim-ms) ease;
}
.expanded .frame { height: var(--content-h); }

.track {
  position: relative;
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
}

.scroller {
  position: relative;
  min-height: var(--collapsed-h);
  max-height: var(--collapsed-h);
  overflow-x: auto;
  overflow-y: hidden;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-left: 8px;
  scroll-behavior: smooth;
}

/* scrollbar */
.scroller::-webkit-scrollbar { height: 6px; }
.scroller::-webkit-scrollbar-track {
  background: color-mix(in srgb, var(--card-bg) 85%, transparent);
  border-radius: 6px;
}
.scroller::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--primary) 60%, #000 0%);
  border-radius: 6px;
}

/* TAB */
.tab {
  contain: layout paint;          /* изоляция для плавных трансформов */
  backface-visibility: hidden;    /* убираем микромыло на GPU */
  will-change: transform;         /* хинт браузеру */
  position: relative;
  flex: 0 0 auto;
  height: 28px;
  padding: 0 14px;
  border-radius: 999px;
  border: 1px solid var(--card-brd);
  background: color-mix(in srgb, var(--card-bg) 92%, transparent);
  color: var(--text);
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: grab;
  white-space: nowrap;
  outline: none;
  transition: transform .12s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
  z-index: 0;
}
.tab:active { cursor: grabbing; }
.tab.active {
  border-color: color-mix(in srgb, var(--primary) 70%, transparent);
  background: color-mix(in srgb, var(--primary) 18%, var(--card-bg));
}
.label { pointer-events: none; }



/* пульсация hover */
@keyframes tabPulse {
  0% { box-shadow: 0 0 0 0 color-mix(in srgb, var(--primary) 0%, transparent); }
  50% { box-shadow: 0 0 14px 0 color-mix(in srgb, var(--primary) 30%, transparent); }
  100% { box-shadow: 0 0 0 0 color-mix(in srgb, var(--primary) 0%, transparent); }
}
.collapsed .tab:hover { transform: translateY(-1px); }
.tab:hover { border-color: color-mix(in srgb, var(--primary) 55%, transparent); }
@media (prefers-reduced-motion: no-preference) {
  .tab:hover { animation: tabPulse 1.1s ease-in-out infinite; }
}
/* раскрыто — без подскока */
.expanded .tab:hover { transform: none; }

/* во время перетаскивания */
.dragging {
  opacity: .95;
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
  transform: scale(0.98);
  animation: none !important;
  z-index: 2;
}

/* пока FLIP идёт — не мешаем hover-тенями */
.animating { pointer-events: none; }

/* toggle */
.toggle {
  height: var(--collapsed-h);
  width: var(--reserve-w);
  display: grid;
  place-items: center;
  color: var(--text);
  background: transparent;
  border: none;
  border-left: 1px solid var(--card-brd);
  cursor: pointer;
  border-top-right-radius: 10px;
  border-bottom-right-radius: 10px;
  transition: background .15s ease, box-shadow .15s ease, color .15s ease, transform .15s ease;
}
.toggle:hover { background: color-mix(in srgb, var(--primary) 12%, var(--card-bg)); color: var(--primary); }
.toggle:active { background: color-mix(in srgb, var(--primary) 22%, var(--card-bg)); transform: scale(0.97); }
.toggle:focus-visible { outline: none; box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 60%, transparent); }

.chev { width: 22px; height: 22px; transition: transform .18s ease; }
.expanded .chev { transform: rotate(180deg); }

.expanded .scroller {
  max-height: max(120px, calc(var(--collapsed-h) * 3));
  display: flex;
  flex-wrap: wrap;
  align-content: flex-start;
  padding-bottom: 10px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* вспомогательное */
.__measuring { position: relative; }
